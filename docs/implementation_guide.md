# 智能推题软件思路指导

## 1. 项目规划与原则
- **开发策略**：采用模块化与组件化设计，优先实现核心闭环（题目推送→草稿→总结→标签→复现），再逐步扩展高级功能。
- **平台与技术栈**：
  - 前端建议基于 **Kotlin + Jetpack Compose** 或 **Flutter** 以适配平板横屏交互。
  - 数据存储使用 **SQLite/Room** 或 **本地文件（CSV/Excel）+同步层**，保证导入导出灵活性。
  - 若需AI解析题库，可预留本地脚本或云端服务接口。
- **文件规范**：草稿、总结表格维持固定三列字段；资源表格按解析后的字段结构化存储。

## 2. 功能迭代建议
1. **MVP阶段**
   - 实现资源表格导入、题目卡片展示、草稿与总结表单输入保存。
   - 简化标签为单层结构，支持手动选择已有标签。
   - 日程模块以固定时间提醒为主。
2. **增强阶段**
   - 引入多层标签树、快捷编号打标签、关联提示卡片。
   - 完善日程（重复计划、任务统计）、题目推送策略（优先级、智能排序）。
   - 加入本地备份/恢复与导出功能。
3. **智能化阶段**
   - 接入AI切题与摘要建议。
   - 根据完成次数与易错点生成复习推荐。
   - 多设备同步与协同编辑。

## 3. 核心流程设计
- **题库导入与解析**：
  1. 用户上传资源表格（xlsx/csv）。
  2. 解析器拆分字段（题干、选项、答案、解析、标签等），写入资源数据库。
  3. 建立题目ID与初始标签/分类映射。
- **推题调度**：
  - 日程模块定时触发推题任务，根据科目与计划数量从资源库中抽取题目。
  - 支持过滤未完成或需复习的题目（依据完成次数/标签）。
- **草稿 & 总结写入流程**：
  1. 用户填写草稿并保存，写入草稿表，记录时间戳与版本。
  2. 展示答案后，用户填写总结并选择学科、知识点、标签，写入总结表。
  3. 同步更新资源表中的完成次数与标签集合。
- **标签同步**：
  - 标签表维护层级结构与所属文件路径。
  - 当笔记添加标签时，在标签对应表格记录笔记ID、题目ID、更新时间。
  - 提供索引以便推题界面快速加载关联总结。
- **复现展示**：
  - 推题时查询总结表/标签表，加载历史总结及提示卡片至右侧上方容器。
  - 草稿区与总结提示区采用可拖拽滑块调整高度，提升可读性。

## 4. 数据结构建议
- **题目表（resource_items）**
  - `id`、`subject`、`question_text`、`options`、`answer`、`analysis`、`tags`、`completed_count`、`schedule_hint`。
- **草稿表（draft_notes）**
  - `id`、`question_id`、`keywords`、`reasoning`、`pitfalls`、`created_at`、`version`。
- **总结表（summary_notes）**
  - `id`、`question_id`、`subject`、`knowledge_subset`、`keywords`、`reasoning`、`pitfalls`、`tags`、`updated_at`。
- **标签表（tag_nodes）**
  - `id`、`name`、`path`、`parent_id`、`shortcode`。
- **标签映射表（tag_relations）**
  - `tag_id`、`summary_id`、`question_id`、`created_at`。
- **日程表（schedules）**
  - `id`、`subject`、`repeat_type`、`time_slots`、`target_count`、`next_trigger_at`。

## 5. 关键交互与UI建议
- **左右分屏布局**：左侧题目卡片可上下滑动；右侧上下分区（总结提示/草稿编辑），支持滑块调整比例。
- **标签操作**：
  - 在总结条目旁显示可点击的标签入口，弹出编号输入框或自动补全下拉。
  - 标签卡片采用颜色或图标区分层级。
- **快捷键与手势**：支持数字键选标签、长按拖拽重新排序标签卡片。
- **导航栏**：底部三栏明确标识“刷题”“日程”“标签”，提供状态提示（如今日剩余题数）。

## 6. 技术实现要点
- **数据持久化**：使用Room数据库与CSV/Excel导入导出工具（如Apache POI、SheetJS）。
- **定时任务**：在Android端利用WorkManager/AlarmManager实现日程触发。
- **文件管理**：标签文件夹与表格对应本地存储路径，提供文件操作API封装。
- **同步扩展**：预留RESTful或GraphQL接口层，支持未来云端同步。
- **AI集成**：可通过本地Python服务或云API对题库进行切分，结果回写资源表。

## 7. 质量保障
- **单元测试**：覆盖数据解析、表格写入、标签关联等核心逻辑。
- **界面测试**：使用Espresso/Compose UI Test验证分屏布局与交互。
- **数据一致性检查**：定期校验草稿、总结与标签关联是否完整，避免孤立记录。
- **备份策略**：提供每日自动备份功能，可导出为压缩包上传云盘。

## 8. 项目里程碑建议
1. **第1阶段（2周）**：完成需求细化、信息架构、原型设计；搭建项目框架与基础数据模型。
2. **第2阶段（3周）**：实现刷题页核心流程（题目展示、草稿/总结保存）、资源导入功能。
3. **第3阶段（3周）**：补全标签系统、日程规划模块、数据表格管理界面。
4. **第4阶段（2周）**：测试与优化，包括性能调优、UI微调、备份导出、BUG修复。
5. **第5阶段（可选）**：智能化功能探索与云同步预研。

## 9. 风险与应对
- **表格数据兼容性**：不同Excel版本字段差异 → 提供模板与字段校验提示。
- **大体量题库性能**：采用分页加载与索引；提前缓存即将推送的题目。
- **标签结构复杂**：设计可视化树形管理器，限制层级深度并提供搜索。
- **用户数据丢失风险**：自动保存、定期备份、操作撤销/回滚功能。
- **AI解析准确性**：在上线前人工校对样本并提供手动调整通道。

## 10. 维护与扩展建议
- 建立数据字典与API文档，统一字段命名。
- 为标签、题库、笔记提供批量操作工具与日志审计。
- 规划插件机制，支持导入不同题型或接入外部题库平台。

